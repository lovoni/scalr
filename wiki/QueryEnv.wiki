#summary Query-Env: a REST API for farm settings

= What's this? =

Query-Env is a way to retrieve various farm settings from any instance of the farm.

For example, you can get a list of all instances, grouped by role name, LVM volumes assigned to an instance, list SSL certificates and virtualhosts.


== Availability and version ==
The current API version is: 2009-03-05


== Reference ==  

The API call is  HTTP or HTTPS GET request to 
https://scalr.net/query-env/API-VERSION/QUERY?

, where QUERY is the name of the query:

* /get-latest-version *
{{{
<?xml version="1.0" encoding="UTF-8"?>
<response>
	<version>2009-03-05</version>
</reponse>
}}}


* /list-ebs-mountpoints *
{{{
<?xml version="1.0" encoding="UTF-8"?>
<response>
	<mountpoints>
		<mountpoint name='some_name_for_LVM' dir='/mnt/storage1' createfs='1' isarray='0'>
			<volumes>
				<volume volume-id='vol-123451' device='/dev/sdb'></volume>
			</volumes>
		</mountpoint>
		<mountpoint name='some_name_for_LVM' dir='/mnt/storage2' createfs='0' isarray='1'>
			<volumes>
				<volume volume-id='vol-123452' device='/dev/sdb'></volume>
				<volume volume-id='vol-123453' device='/dev/sdc'></volume>
			</volumes>
		</mountpoint>
	</mountpoints>
</response>
}}}


* /list-roles?[role=STRING][behaviour=STRING] *
{{{
<?xml version="1.0" encoding="UTF-8"?>
<response>
	<roles>
		<role behaviour="mysql" name="mysql-lvm">
			<hosts>
				<host index='1' replication-master="1" internal-ip="211.31.14.198" external-ip="211.31.14.198" />
				<host index='2' replication-master="0" internal-ip="211.31.14.198" external-ip="211.31.14.198" />
			</hosts>
		</role>
		<role behaviour="www" name="www64">
			<hosts>
				<host index='1' internal-ip="211.31.14.198" external-ip="211.31.14.198" />
				<host index='2' internal-ip="211.31.14.198" external-ip="211.31.14.198" />
			</hosts>
		</role>
		<role behaviour="www" name="www-custom">
			<hosts>
				<host index='1' internal-ip="211.31.14.198" external-ip="211.31.14.198" />
				<host index='2' internal-ip="211.31.14.198" external-ip="211.31.14.198" />
			</hosts>
		</role>
	</roles>
</response>
}}}


* /get-https-certificate *
{{{
<?xml version="1.0" encoding="UTF-8"?>
<response>
	<cert>MIICWjCCAhigAwIBAgIESPX5.....1myoZSPFYXZ3AA9kwc4uOwhN</cert>
	<pkey>MIICWjCCAhigAwIBAgIESPX5.....1myoZSPFYXZ3AA9kwc4uOwhN</pkey>
</response>
}}}

* /list-role-params?[name=STRING] *
{{{
<?xml version="1.0" encoding="UTF-8"?>
<response>
<params>
	<param name="external_ips_to_allow_access_from">
		<value>
			<![CDATA[
					
			]]>
		</value>
	</param>
</params>
</response>		
}}}
					
* /list-virtualhosts?[name=gpanel.net][https=1|0] *
{{{
<?xml version="1.0" encoding="UTF-8"?>
<response>
	<vhosts>
		<vhost hostname="gpanel.net" type="apache">
			<raw>
				<![CDATA[

				]]>
			</raw>			
		</vhost>
			
		<vhost hostname="gpanel2.net" https="1" type="nginx">
			<raw>
				<![CDATA[
				
				]]>
			</raw>				
		</vhost>
	</vhosts>
</response>
}}}

* /list-scripts?[event=STRING][asynchronous=1|0][name=STRING] *
{{{
<?xml version="1.0" encoding="UTF-8"?>
<response>
	<scripts>
		<script asynchronous="1" exec-timeout="100" name="script_name">
			<body>
				<![CDATA[
		
				]]>
			</body>
		</script>
	</scripts>
</response>
}}}